(()=>{"use strict";var e={d:(t,n)=>{for(var o in n)e.o(n,o)&&!e.o(t,o)&&Object.defineProperty(t,o,{enumerable:!0,get:n[o]})},o:(e,t)=>Object.prototype.hasOwnProperty.call(e,t)};function t(e,t,n){!function(e){return e.some((function(e){return!e.validity.valid}))}(e)?(t.disabled=!1,t.classList.remove(n.inactiveButtonClass)):(t.disabled=!0,t.classList.add(n.inactiveButtonClass))}function n(e){e.disabled=!0,e.classList.add("popup__form-button_type_disabled")}e.d({},{hw:()=>z,Cv:()=>H,IG:()=>M});var o={baseUrl:"https://nomoreparties.co/v1/plus-cohort-10",headers:{authorization:"6d23207f-ca89-460f-9fce-a2d606110ebd","Content-Type":"application/json"}};function r(e){return e.ok?e.json():Promise.reject("Ошибка: ".concat(e.status))}function c(){return fetch("".concat(o.baseUrl,"/users/me"),{method:"GET",headers:o.headers}).then(r)}function u(e){e.classList.add("popup_opened"),document.addEventListener("keydown",i),e.addEventListener("mousedown",l)}function a(e){e.classList.remove("popup_opened"),document.removeEventListener("keydown",i),document.removeEventListener("mousedown",l)}function i(e){"Escape"===e.key&&a(document.querySelector(".popup_opened"))}function l(e){(e.target.classList.contains("popup_opened")||e.target.classList.contains("popup__close-button"))&&a(document.querySelector(".popup_opened"))}var s=document.querySelector("#card-constructor").content,d=document.querySelector(".elements"),p=document.querySelector(".popup-edit"),f=document.querySelector(".popup-add"),m=document.querySelector(".popup-viewer"),_=document.querySelector(".profile__edit-button"),v=document.querySelector(".profile__add-button"),y=document.querySelector(".popup-edit__close-button"),h=document.querySelector(".popup-add__close-button"),S=document.querySelector(".popup-image__close-button"),b=document.querySelector(".popup__form_edit-profile"),q=document.querySelector(".popup__form-input_field-name"),L=document.querySelector(".popup__form-input_field-about"),g=document.querySelector(".popup__form_add-place"),k=document.querySelector(".popup__form-input_place-name"),E=document.querySelector(".popup__form-input_place-link"),C=document.querySelector(".profile__name"),x=document.querySelector(".profile__about"),w=document.querySelector(".profile__avatar"),A=document.querySelector(".profile__avatar-button"),U=document.querySelector(".popup__form-button-change-avatar"),T=document.querySelector(".popup-avatar"),O=document.querySelector(".popup__form-input_avatar-link"),P=document.querySelector(".popup__form_change-avatar"),j=document.querySelector(".popup__form-button_add-place"),I=document.querySelector(".popup__form-button-profile-submit");function D(e,t,n){var o=e.querySelector(".element__likes-counter");t.classList.toggle("element__like_active"),o.textContent=n.likes.length}function B(e,t){var n=e.name,o=e.link,r=e._id,c=e.owner,a=e.likes,i=s.querySelector(".element").cloneNode(!0),l=i.querySelector(".element__image"),d=i.querySelector(".element__delete-icon"),p=i.querySelector(".element__like");return i.querySelector(".element__title").textContent=n,l.src=o,l.alt=n,function(e,t,n,o,r,c){var a=o.name,i=o.link;e.addEventListener("click",(function(){!function(e){var t=document.querySelector(".popup-viewer"),n=document.querySelector(".popup__image"),o=document.querySelector(".popup__image-description");n.src=e.link,n.alt=e.name,o.textContent=e.name,u(t)}({name:a,link:i})})),t.addEventListener("click",(function(){z(r,c)})),n.addEventListener("click",(function(){!function(e,t,n){t.classList.contains("element__like_active")?H(e,t,n):M(e,t,n)}(c,n,r)}))}(l,d,p,{name:n,link:o},r,i),function(e,t,n){t._id!==n&&e.classList.add("element__delete-icon_type_hidden")}(d,c,t),function(e,t,n){var o=e.querySelector(".element__like");e.querySelector(".element__likes-counter").textContent=n.length.toString(),function(e,t){return!!e.some((function(e){return e._id===t}))}(n,t)?o.classList.add("element__like_active"):o.classList.remove("element__like_active")}(i,t,a),i}function N(e,t){t.textContent=e?"Сохранение...":"Сохранить"}function G(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var o,r,c=[],u=!0,a=!1;try{for(n=n.call(e);!(u=(o=n.next()).done)&&(c.push(o.value),!t||c.length!==t);u=!0);}catch(e){a=!0,r=e}finally{try{u||null==n.return||n.return()}finally{if(a)throw r}}return c}}(e,t)||function(e,t){if(e){if("string"==typeof e)return J(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?J(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function J(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,o=new Array(t);n<t;n++)o[n]=e[n];return o}function H(e,t,n){var c;(c=n,fetch("".concat(o.baseUrl,"/cards/likes/").concat(c),{method:"DELETE",headers:o.headers}).then(r)).then((function(n){D(e,t,n)})).catch((function(e){return console.log("Ошибка статуса лайка: ".concat(e))}))}function M(e,t,n){var c;(c=n,fetch("".concat(o.baseUrl,"/cards/likes/").concat(c),{method:"PUT",headers:o.headers}).then(r)).then((function(n){D(e,t,n)})).catch((function(e){return console.log("Ошибка статуса лайка: ".concat(e))}))}function z(e,t){var n;(n=e,fetch("".concat(o.baseUrl,"/cards/").concat(n),{method:"DELETE",headers:o.headers}).then(r)).then((function(){!function(e){e.remove(),e=null}(t)})).catch((function(e){return console.log("Ошибка удаления: ".concat(e))}))}!function(e){Array.from(document.querySelectorAll(e.formSelector)).forEach((function(n){n.addEventListener("submit",(function(e){e.preventDefault()})),function(e,n){var o=Array.from(e.querySelectorAll(n.inputSelector)),r=e.querySelector(n.submitButtonSelector);t(o,r,n),o.forEach((function(c){c.addEventListener("input",(function(){!function(e,t,n){t.validity.valid?function(e,t,n){var o=e.querySelector("#".concat(t.id,"-error"));o.textContent="",o.classList.remove(n.errorClass),t.classList.remove(n.invalidInput)}(e,t,n):function(e,t,n,o){var r=e.querySelector("#".concat(t.id,"-error"));r.textContent=n,r.classList.add(o.errorClass),t.classList.add(o.invalidInput)}(e,t,t.validationMessage,n)}(e,c,n),t(o,r,n)}))}))}(n,e)}))}({formSelector:".popup__form",inputSelector:".popup__form-input",submitButtonSelector:".popup__form-button",inactiveButtonClass:"popup__form-button_type_disabled",invalidInput:"popup__form-input_type_ivalid",errorClass:"error_active"}),_.addEventListener("click",(function(){var e;e=p,q.value=C.textContent,L.value=x.textContent,u(e)})),y.addEventListener("click",(function(){a(p)})),v.addEventListener("click",(function(){u(f)})),h.addEventListener("click",(function(){a(f)})),S.addEventListener("click",(function(){a(m)})),A.addEventListener("click",(function(){u(T)})),Promise.all([c(),fetch("".concat(o.baseUrl,"/cards"),{method:"GET",headers:o.headers}).then(r)]).then((function(e){var t=G(e,2),n=t[0],o=t[1];!function(e){w.src=e.avatar,C.textContent=e.name,x.textContent=e.about}(n),Array.from(o).forEach((function(e){var t;t=B(e,n._id),d.append(t)}))})).catch((function(e){return console.log(e)})),P.addEventListener("submit",(function(e){var t;e.preventDefault(),N(!0,U),(t=O.value,fetch("".concat(o.baseUrl,"/users/me/avatar"),{method:"PATCH",headers:o.headers,body:JSON.stringify({avatar:t})}).then(r)).then((function(){w.src=O.value,a(T),n(U),e.target.reset(),c()})).catch((function(e){return console.log("Ошибка: ".concat(e))})).finally((function(){N(!1,U)}))})),g.addEventListener("submit",(function(e){var t,u;e.preventDefault(),N(!0,j),Promise.all([(t=k.value,u=E.value,fetch("".concat(o.baseUrl,"/cards"),{method:"POST",headers:o.headers,body:JSON.stringify({name:t,link:u})}).then(r)),c()]).then((function(e){var t,n=G(e,2);t=B(n[0],n[1]._id),d.prepend(t)})).then((function(){n(j),a(f),e.target.reset()})).catch((function(e){return console.log("Ошибка: ".concat(e))})).finally((function(){N(!1,j)}))})),b.addEventListener("submit",(function(e){var t,n;e.preventDefault(),N(!0,I),(t=q.value,n=L.value,fetch("".concat(o.baseUrl,"/users/me"),{method:"PATCH",headers:o.headers,body:JSON.stringify({name:t,about:n})})).then((function(){C.textContent=q.value,x.textContent=L.value,a(p)})).catch((function(e){return console.log("Ошибка: ".concat(e))})).finally((function(){N(!1,I)}))}))})();